# Saga Оркестрация

## Saga состояния

| Номер | Состояние | Описание |
|-------|-----------|----------|
| 1 | payment_initiated | Пользователь инициирует запрос на оплату |
| 2 | amount_blocked | Блокировка суммы на счету пользователя |
| 3 | fraud_check_pending | Проверка транзакции на мошенничество |
| 4 | fraud_check_manual | Ручная проверка мошенничества |
| 5 | fraud_check_success | Выполнение платежа |
| 6 | fraud_check_failed | Отмена платежа из-за мошенничества |
| 7 | amount_released | Разблокировка суммы на счету пользователя |
| 8 | payment_executed | Платеж успешно выполнен |
| 9 | success_notified | Уведомление пользователя об успешном платеже |
| 10 | failure_notified | Уведомление пользователя о неудачном платеже |

## Saga транзакции

| Транзакция | Описание | Тип События | Компенсация |
|------------|----------|-------------|-------------|
| initiate_payment | Пользователь инициирует запрос на оплату | Повторяемая | Нет |
| block_amount | Блокировка суммы на счету пользователя | Компенсируемая | release_amount |
| send_fraud_check | Отправить проверку на мошенничество | Повторяемая | Нет |
| fraud_success | Выполнение платежа | Повторяемая | Нет |
| fraud_failure | Отмена платежа из-за мошенничества | Компенсируемая | release_amount |
| fraud_manual_review | Ручная проверка мошенничества | Повторяемая | Нет |
| fraud_manual_approve | Одобрение платежа после ручной проверки | Повторяемая | Нет |
| fraud_manual_reject | Отклонение платежа после ручной проверки | Компенсируемая  | release_amount |
| release_amount | Разблокировка суммы на счету пользователя | Повторяемая | Нет |
| execute_payment | Платеж успешно выполнен | Необратимая | Нет |
| notify_success | Уведомление пользователя об успешном платеже | Необратимая | Нет |
| notify_failure | Уведомление пользователя о неудачном платеже | Необратимая | Нет |
